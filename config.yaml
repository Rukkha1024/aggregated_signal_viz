# === Data Settings ===
data:
  input_file: "data/merged.parquet"
  features_file: "/mnt/c/Users/Alice/OneDrive - 청주대학교/근전도 분석 코드/EMG_analysis/output/final_dataset.csv"
  id_columns:
    subject: "subject"
    velocity: "velocity"
    trial: "trial_num"
    frame: "DeviceFrame"
    mocap_frame: "MocapFrame"
    onset: "platform_onset"
    offset: "platform_offset"
    task: "task"
  task_filter: "perturb"
  # Sampling rates and frame ratio (MocapFrame → DeviceFrame)
  device_sample_rate: 1000
  mocap_sample_rate: 100
  frame_ratio: 10

# === Signal Groups ===
signal_groups:
  emg:
    columns: [TA, EHL, MG, SOL, PL, RF, VL, ST, RA, EO, IO, SCM, GM, ESC, EST, ESL]
    grid_layout: [4, 4]
  forceplate:
    columns: [Fx, Fy, Fz]
    grid_layout: [1, 3]
  cop:
    columns: [Cx, Cy]
    grid_layout: [1, 1]

# === Interpolation ===
interpolation:
  method: "linear"
  target_length: 500
  start_ms: -100
  end_ms: 800

# === Aggregation Modes ===
aggregation_modes:
  subject_mean:
    enabled: true
    groupby: ["subject"]
    output_dir: "output/subject_mean"
    filename_pattern: "{subject}_mean_{signal_group}.png"
  grand_mean:
    enabled: true
    groupby: []
    output_dir: "output/grand_mean"
    filename_pattern: "grand_mean_{signal_group}.png"
  filtered_mean:
    enabled: true
    filter:
      column: "velocity"
      value: 10.0
    groupby: []
    output_dir: "output/filtered_mean"
    filename_pattern: "vel10_mean_{signal_group}.png"

# === 플롯 스타일 ===
plot_style:
  # 공통
  common:
    dpi: 300
    grid_alpha: 0.3
    tick_labelsize: 7
    title_fontsize: 14
    title_fontweight: "bold"
    title_pad: 5
    label_fontsize: 8
    legend_loc: "best"
    legend_framealpha: 0.8
    tight_layout_rect: [0, 0, 1, 0.99]
    savefig_bbox_inches: "tight"
    savefig_facecolor: "white"
    font_family: "NanumGothic"
    show_onset_marker: false
    show_max_marker: false

  # EMG 전용
  emg:
    subplot_size: [18, 9]
    line_color: "blue"
    line_width: 0.8
    line_alpha: 0.8
    window_span_alpha: 0.15
    onset_marker_color: "red"
    onset_marker_linestyle: "--"
    onset_marker_linewidth: 1.5
    max_marker_color: "orange"
    max_marker_linestyle: "--"
    max_marker_linewidth: 1.5
    legend_fontsize: 4
    x_label: "Normalized time (0-1)"
    y_label: "{channel}"

  # Forceplate 전용
  forceplate:
    subplot_size: [12, 6]
    line_colors:
      Fx: "purple"
      Fy: "brown"
      Fz: "green"
    line_width: 0.8
    line_alpha: 0.8
    window_span_alpha: 0.15
    onset_marker_color: "red"
    onset_marker_linestyle: "--"
    onset_marker_linewidth: 1.5
    legend_fontsize: 10
    x_label: "Normalized time (0-1)"
    y_label: "{channel} Value"

  # COP 전용
  cop:
    subplot_size: [8, 8]
    scatter_size: 8
    scatter_alpha: 0.7
    background_color: "lightgray"
    background_alpha: 0.3
    background_size: 6
    window_colors:
      p1: "#4E79A7"
      p2: "#F28E2B"
      p3: "#E15759"
      p4: "#59A14F"
    max_marker_color: "#ED1C24"
    max_marker_size: 80
    max_marker_symbol: "*"
    max_marker_edgecolor: "white"
    max_marker_linewidth: 1
    max_marker_zorder: 10
    legend_fontsize: 10
    x_label: "Cx (R+/L-)"
    y_label: "Cy (A+)"
    y_invert: true

# === Window Definitions (relative to platform_onset in ms) ===
windows:
  reference_event: "platform_onset"
  definitions:
    p1:
      start_ms: 0
      end_ms: 200
    p2:
      start_ms: 200
      end_ms: 400
    p3:
      start_ms: 400
      end_ms: 600
    p4:
      start_ms: 600
      end_ms: 800

# === Output Settings ===
output:
  base_dir: "output"
