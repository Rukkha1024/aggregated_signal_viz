# === Data Settings ===
data:
  input_file: "data/merged.parquet"
  features_file: "/mnt/c/Users/Alice/OneDrive - 청주대학교/근전도 분석 코드/EMG_analysis/output/final_dataset.csv"
  id_columns:
    subject: "subject"
    velocity: "velocity"
    trial: "trial_num"
    frame: "DeviceFrame"
    mocap_frame: "MocapFrame"
    onset: "platform_onset"
    offset: "platform_offset"
    task: "task"
  task_filter: "perturb"
  # Sampling rates and frame ratio (MocapFrame → DeviceFrame)
  device_sample_rate: 1000
  mocap_sample_rate: 100
  frame_ratio: 10

# === Signal Groups ===
signal_groups:
  emg:
    columns: [TA, EHL, MG, SOL, PL, RF, VL, ST, RA, EO, IO, SCM, GM, ESC, EST, ESL]
    grid_layout: [4, 4]
  forceplate:
    columns: [Fx_zero, Fy_zero, Fz_zero, Mx_zero, My_zero, Mz_zero]
    grid_layout: [2, 3]
  cop:
    columns: [Cx_zero, Cy_zero]
    grid_layout: [1, 3]

# === Interpolation ===
interpolation:
  method: "linear"
  target_length: 500
  start_ms: -100
  end_ms: 800

# === Aggregation Modes ===
aggregation_modes:
  diff_age_group_step_TF_mean:
    enabled: true
    filter:
      column: "mixed"
      value: 1
    groupby: ["age_group", "step_TF"]
    color_by: ["age_group", "step_TF"]
    overlay: true
    output_dir: "output/diff"
    filename_pattern: "diff_age_group_step_TF_mean_{signal_group}.png"

# === 플롯 스타일 ===
plot_style:
  # 공통 설정 (모든 신호 타입에 적용)
  common:
    dpi: 300
    grid_alpha: 0.3                    # 격자선 투명도 (0=완전투명, 1=완전불투명)
    tick_labelsize: 7                  # 축 눈금 폰트 크기 (포인트)
    title_fontsize: 14                 # 제목 폰트 크기
    title_fontweight: "bold"           # 제목 굵기 ("bold", "normal")
    title_pad: 5                       # 제목과 그래프 사이 간격 (포인트)
    label_fontsize: 8                  # 축 라벨 폰트 크기
    legend_loc: "best"                 # legend 위치 ("best", "upper left", "lower right" 등)
    legend_framealpha: 0.8             # legend 배경 투명도
    legend_label_threshold: 6          # groupby column의 unique 값이 이 값 이상이면 legend에서 제외
    tight_layout_rect: [0, 0, 1, 0.99] # 레이아웃 여백 [left, bottom, right, top]
    savefig_bbox_inches: "tight"       # 저장 시 테두리 처리 ("tight"로 여백 최소화)
    savefig_facecolor: "white"         # 배경색 ("white", "gray" 등)
    font_family: "NanumGothic"         # 폰트 ("NanumGothic", "Arial" 등)
    show_onset_marker: false           # platform_onset 마커 표시 여부
    show_max_marker: false             # 최댓값 마커 표시 여부

  # EMG 신호 전용 설정
  emg:
    subplot_size: [18, 9]              # 그리드 크기 (가로, 세로) 인치. 예: [18,9]는 18"x9" 캔버스
    line_color: "gray"                 # 라인 색상 (RGB 색상명 또는 16진수 "#0000FF")
    line_width: 1.2                    # 라인 두께 (포인트)
    line_alpha: 0.8                    # 라인 투명도 (0=투명, 1=불투명)
    window_span_alpha: 0.15            # 윈도우 배경 투명도 (p1,p2,p3,p4 구간 표시용)
    onset_marker_color: "red"          # onset 마커 색상
    onset_marker_linestyle: "--"       # onset 마커 스타일 ("--"=점선, "-"=실선, ":"=점)
    onset_marker_linewidth: 1.5        # onset 마커 두께
    max_marker_color: "orange"         # 최댓값 마커 색상
    max_marker_linestyle: "--"         # 최댓값 마커 스타일
    max_marker_linewidth: 1.5          # 최댓값 마커 두께
    legend_fontsize: 4                 # legend 폰트 크기 (채널이 많아서 작게 설정)
    x_label: "Normalized time (0-1)"   # X축 라벨 (0=시작, 1=끝)
    y_label: "{channel}"               # Y축 라벨 ({channel}은 동적 치환: TA, RF 등)

  # Forceplate 신호 전용 설정
  forceplate:
    subplot_size: [15, 10]             # 그리드 크기 (가로, 세로) 인치
    line_colors:                       # 각 채널별 라인 색상 매핑
      Fx: "purple"                     # 전후방향 힘 (보라)
      Fy: "brown"                      # 좌우방향 힘 (갈색)
      Fz: "green"                      # 수직 힘 (초록)
    line_width: 1.2                    # 라인 두께
    line_alpha: 0.8                    # 라인 투명도
    window_span_alpha: 0.15            # 윈도우 배경 투명도
    onset_marker_color: "red"          # onset 마커 색상
    onset_marker_linestyle: "--"       # onset 마커 스타일
    onset_marker_linewidth: 1.5        # onset 마커 두께
    legend_fontsize: 5                 # legend 폰트 크기 (채널 수가 적어서 크게)
    x_label: "Normalized time (0-1)"   # X축 라벨
    y_label: "{channel} Value"         # Y축 라벨 (예: "Fx Value", "Fy Value")

  # COP (Center of Pressure) 신호 전용 설정
  cop:
    subplot_size: [18, 5]              # 그리드 크기 (가로, 세로) 인치 (1×3 mixed plot)
    scatter_size: 8                    # 산점도 점 크기 (마커 크기)
    scatter_alpha: 0.7                 # 산점도 점 투명도 (궤적 시각화용)
    background_color: "lightgray"      # 배경 색상
    background_alpha: 0.3              # 배경 투명도
    background_size: 6                 # 배경 점 크기
    window_span_alpha: 0.15            # 시계열 플롯의 윈도우 배경 투명도
    line_colors:
      Cx: "blue"
      Cy: "red"
    line_width: 1.2
    line_alpha: 0.8
    window_colors:                     # 각 윈도우 기간별 색상 (p1~p4)
      p1: "#4E79A7"                    # 0-200ms (파란색)
      p2: "#F28E2B"                    # 200-400ms (주황색)
      p3: "#E15759"                    # 400-600ms (빨간색)
      p4: "#59A14F"                    # 600-800ms (초록색)
    max_marker_color: "#ED1C24"        # 최댓값 마커 색상 (빨강)
    max_marker_size: 80                # 최댓값 마커 크기 (통상 점보다 큼)
    max_marker_symbol: "*"             # 최댓값 마커 모양 ("*"=별, "o"=원, "s"=사각형)
    max_marker_edgecolor: "white"      # 최댓값 마커 테두리 색상
    max_marker_linewidth: 1            # 최댓값 마커 테두리 두께
    max_marker_zorder: 10              # 최댓값 마커 겹침순서 (값 클수록 위에)
    legend_fontsize: 5                 # legend 폰트 크기
    x_label_time: "Normalized time (0-1)"
    y_label_cx: "Cx (R+/L-)"
    y_label_cy: "Cy (A+)"
    x_label: "Cx (R+/L-)"              # X축 라벨 (오른쪽 양수, 왼쪽 음수)
    y_label: "Cy (A+)"                 # Y축 라벨 (앞쪽 양수)
    y_invert: true                     # Y축 반전 여부 (true면 위쪽이 음수)

# === Window Definitions (relative to platform_onset in ms) ===
windows:
  reference_event: "platform_onset"
  definitions:
    p1:
      start_ms: 0
      end_ms: 200
    p2:
      start_ms: 200
      end_ms: 400
    p3:
      start_ms: 400
      end_ms: 600
    p4:
      start_ms: 600
      end_ms: 800

# === Output Settings ===
output:
  base_dir: "output"
